/*!
* MarchingSquaresJS
* version 1.2.3
* https://github.com/RaumZeit/MarchingSquares.js
*
* @license GNU Affero General Public License.
* Copyright (c) 2015-2018 Ronny Lorenz <ronny@tbi.univie.ac.at>
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.MarchingSquaresJS=e.MarchingSquaresJS||{})}(this,function(e){"use strict";var t={successCallback:null,verbose:!1,polygons:!1,polygons_full:!1,linearRing:!0},h=Object.assign({interpolate:function(e,t,o,n){return n<o&&(n=o=n),e<t?e<o?(o-e)/(t-e):(n-e)/(t-e):n<e?(e-n)/(e-t):(e-o)/(e-t)},interpolate_a:function(e,t,o,n){return e<t?(o-e)/(t-e):(e-n)/(e-t)},interpolate_b:function(e,t,o,n){return e<t?(n-e)/(t-e):(e-o)/(e-t)}},t),m=Object.assign({interpolate:function(e,t,o){return e<t?(o-e)/(t-e):(e-o)/(e-t)}},t);function c(e,t){for(var o=e.rows,n=e.cols,a=[],r=0;r<o;r++)for(var l=0;l<n;l++){if(void 0!==e.cells[r][l])e.cells[r][l].polygons.forEach(function(e){e.forEach(function(e){e[0]+=l,e[1]+=r}),t.linearRing&&e.push(e[0]),a.push(e)})}return a}function S(e,t,o,n){var a=e,r=t;return 0===o?(a+=1,r+=n[0][1]):1===o?a+=n[0][0]:2===o?r+=n[0][1]:3===o&&(a+=n[0][0],r+=1),[a,r]}function q(e,t,o){var n=e,a=t;return 0===o?n++:1===o||(2===o?a++:3===o&&(n++,a++)),[n,a]}function o(e,t,o){var n={};if(!e)throw new Error("data is required");if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Error("data should be an array of arrays");if(null==t)throw new Error("threshold is required");if(isNaN(+t))throw new Error("threshold must be a number");if(o&&"object"!=typeof o)throw new Error("options must be an object");o=o||{};for(var a=Object.keys(m),r=0;r<a.length;r++){var l=a[r],s=o[l];s=null!=s?s:m[l],n[l]=s}n.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+t),n.polygons_full=!n.polygons;var p,i={rows:e.length-1,cols:e[0].length-1,cells:[],threshold:t};n.threshold=t;for(var g=0;g<i.rows;++g){i.cells[g]=[];for(r=0;r<i.cols;++r)i.cells[g][r]=b(e,r,g,n)}return n.polygons?(n.verbose&&console.log("MarchingSquaresJS-isoContours: returning single polygons for each grid cell"),p=c(i,n)):(n.verbose&&console.log("MarchingSquaresJS-isoContours: returning iso lines (polygon paths) for entire data grid"),p=function(e,t){for(var o=e.rows,n=e.cols,a=[],r=["right","bottom","left","top"],l=[0,-1,0,1],s=[-1,0,1,0],p={bottom:1,left:2,top:3,right:0},i=!0,g=0;g<o;g++)if(e.cells[g][0].x0>=e.threshold||e.cells[g][n-1].x1>=e.threshold){i=!1;break}if(i&&(e.cells[o-1][0].x3>=e.threshold||e.cells[o-1][n-1].x2>=e.threshold)&&(i=!1),i)for(var m=0;m<n-1;m++)if(e.cells[0][m].x1>=e.threshold||e.cells[o-1][m].x2>e.threshold){i=!1;break}for(i&&(t.linearRing?a.push([[0,0],[0,o],[n,o],[n,0],[0,0]]):a.push([[0,0],[0,o],[n,o],[n,0]])),g=0;g<o;g++)for(m=0;m<n;m++)if(void 0!==e.cells[g][m]){var b=e.cells[g][m];if(15===b.cval)continue;for(var h=null,c=0;c<4;c++)if(h=r[c],"object"==typeof b.edges[h]){var u=[],_=h,y=m,x=g,V=!1,f=[m+(v=b.edges[h]).path[0][0],g+v.path[0][1]];for(u.push(f);!V;){var d=e.cells[x][y];if("object"!=typeof d.edges[_])break;var v=d.edges[_];delete d.edges[_];var k=v.path[1];if(k[0]+=y,k[1]+=x,u.push(k),_=v.move.enter,y+=v.move.x,x+=v.move.y,void 0===e.cells[x]||void 0===e.cells[x][y]){if(!t.linearRing)break;var w=0,B=0;if(y===n?(y--,w=0):y<0?(y++,w=2):x===o?(x--,w=3):x<0&&(x++,w=1),y===m&&x===g&&w===p[h]){V=!0,_=h;break}for(;;){var C=!1;if(4<B){console.log("Direction change counter overflow! This should never happen!");break}d=e.cells[x][y];var N=r[w];if("object"==typeof d.edges[N]){v=d.edges[N],u.push(S(y,x,w,v.path)),_=N,C=!0;break}if(C)break;if(u.push(q(y,x,w)),y+=l[w],x+=s[w],void 0!==e.cells[x]&&void 0!==e.cells[x][y]||(y-=l[w],x-=s[w],w=(w+1)%4,B++),y===m&&x===g&&w===p[h]){V=!0,_=h;break}}}}!t.linearRing||u[u.length-1][0]===f[0]&&u[u.length-1][1]===f[1]||u.push(f),a.push(u)}}return a}(i,n)),"function"==typeof n.successCallback&&n.successCallback(p),p}function b(e,t,o,n){var a=0,r=e[o+1][t],l=e[o+1][t+1],s=e[o][t+1],p=e[o][t],i=n.threshold;if(!(isNaN(p)||isNaN(s)||isNaN(l)||isNaN(r))){a|=i<=r?8:0,a|=i<=l?4:0,a|=i<=s?2:0;var g={cval:a=+(a|=i<=p?1:0),polygons:[],edges:{},x0:p,x1:s,x2:l,x3:r};switch(a){case 0:n.polygons&&g.polygons.push([[0,0],[0,1],[1,1],[1,0]]);break;case 15:break;case 14:var m=n.interpolate(p,r,i),b=n.interpolate(p,s,i);n.polygons_full&&(g.edges.left={path:[[0,m],[b,0]],move:{x:0,y:-1,enter:"top"}}),n.polygons&&g.polygons.push([[0,0],[0,m],[b,0]]);break;case 13:b=n.interpolate(p,s,i);var h=n.interpolate(s,l,i);n.polygons_full&&(g.edges.bottom={path:[[b,0],[1,h]],move:{x:1,y:0,enter:"left"}}),n.polygons&&g.polygons.push([[b,0],[1,h],[1,0]]);break;case 11:h=n.interpolate(s,l,i);var c=n.interpolate(r,l,i);n.polygons_full&&(g.edges.right={path:[[1,h],[c,1]],move:{x:0,y:1,enter:"bottom"}}),n.polygons&&g.polygons.push([[1,h],[c,1],[1,1]]);break;case 7:m=n.interpolate(p,r,i),c=n.interpolate(r,l,i);n.polygons_full&&(g.edges.top={path:[[c,1],[0,m]],move:{x:-1,y:0,enter:"right"}}),n.polygons&&g.polygons.push([[c,1],[0,m],[0,1]]);break;case 1:m=n.interpolate(p,r,i),b=n.interpolate(p,s,i);n.polygons_full&&(g.edges.bottom={path:[[b,0],[0,m]],move:{x:-1,y:0,enter:"right"}}),n.polygons&&g.polygons.push([[b,0],[0,m],[0,1],[1,1],[1,0]]);break;case 2:b=n.interpolate(p,s,i),h=n.interpolate(s,l,i);n.polygons_full&&(g.edges.right={path:[[1,h],[b,0]],move:{x:0,y:-1,enter:"top"}}),n.polygons&&g.polygons.push([[0,0],[0,1],[1,1],[1,h],[b,0]]);break;case 4:h=n.interpolate(s,l,i),c=n.interpolate(r,l,i);n.polygons_full&&(g.edges.top={path:[[c,1],[1,h]],move:{x:1,y:0,enter:"left"}}),n.polygons&&g.polygons.push([[0,0],[0,1],[c,1],[1,h],[1,0]]);break;case 8:m=n.interpolate(p,r,i),c=n.interpolate(r,l,i);n.polygons_full&&(g.edges.left={path:[[0,m],[c,1]],move:{x:0,y:1,enter:"bottom"}}),n.polygons&&g.polygons.push([[0,0],[0,m],[c,1],[1,1],[1,0]]);break;case 12:m=n.interpolate(p,r,i),h=n.interpolate(s,l,i);n.polygons_full&&(g.edges.left={path:[[0,m],[1,h]],move:{x:1,y:0,enter:"left"}}),n.polygons&&g.polygons.push([[0,0],[0,m],[1,h],[1,0]]);break;case 9:b=n.interpolate(p,s,i),c=n.interpolate(r,l,i);n.polygons_full&&(g.edges.bottom={path:[[b,0],[c,1]],move:{x:0,y:1,enter:"bottom"}}),n.polygons&&g.polygons.push([[b,0],[c,1],[1,1],[1,0]]);break;case 3:m=n.interpolate(p,r,i),h=n.interpolate(s,l,i);n.polygons_full&&(g.edges.right={path:[[1,h],[0,m]],move:{x:-1,y:0,enter:"right"}}),n.polygons&&g.polygons.push([[0,m],[0,1],[1,1],[1,h]]);break;case 6:b=n.interpolate(p,s,i),c=n.interpolate(r,l,i);n.polygons_full&&(g.edges.top={path:[[c,1],[b,0]],move:{x:0,y:-1,enter:"top"}}),n.polygons&&g.polygons.push([[0,0],[0,1],[c,1],[b,0]]);break;case 10:m=n.interpolate(p,r,i),h=n.interpolate(s,l,i),b=n.interpolate(p,s,i),c=n.interpolate(r,l,i);var u=(p+s+l+r)/4;n.polygons_full&&(u<i?(g.edges.left={path:[[0,m],[c,1]],move:{x:0,y:1,enter:"bottom"}},g.edges.right={path:[[1,h],[b,0]],move:{x:0,y:-1,enter:"top"}}):(g.edges.right={path:[[1,h],[c,1]],move:{x:0,y:1,enter:"bottom"}},g.edges.left={path:[[0,m],[b,0]],move:{x:0,y:-1,enter:"top"}})),n.polygons&&(u<i?g.polygons.push([[0,0],[0,m],[c,1],[1,1],[1,h],[b,0]]):(g.polygons.push([[0,0],[0,m],[b,0]]),g.polygons.push([[c,1],[1,1],[1,h]])));break;case 5:m=n.interpolate(p,r,i),h=n.interpolate(s,l,i),b=n.interpolate(p,s,i),c=n.interpolate(r,l,i),u=(p+s+l+r)/4;n.polygons_full&&(u<i?(g.edges.bottom={path:[[b,0],[0,m]],move:{x:-1,y:0,enter:"right"}},g.edges.top={path:[[c,1],[1,h]],move:{x:1,y:0,enter:"left"}}):(g.edges.top={path:[[c,1],[0,m]],move:{x:-1,y:0,enter:"right"}},g.edges.bottom={path:[[b,0],[1,h]],move:{x:1,y:0,enter:"left"}})),n.polygons&&(u<i?g.polygons.push([[0,m],[0,1],[c,1],[1,h],[1,0],[b,0]]):(g.polygons.push([[0,m],[0,1],[c,1]]),g.polygons.push([[b,0],[1,h],[1,0]])))}return g}}var u={lowerBound:null,upperBound:null,childA:null,childB:null,childC:null,childD:null};function _(e,t){return function e(t,o,n,a,r){var l=Object.assign({x:o,y:n,dx:a,dy:r},u),s=a,p=r,i=0,g=0;if(1===a&&1===r)l.lowerBound=Math.min(t[n][o],t[n][o+1],t[n+1][o+1],t[n+1][o]),l.upperBound=Math.max(t[n][o],t[n][o+1],t[n+1][o+1],t[n+1][o]);else{if(1<a){for(;0!==s;)s>>=1,i++;a===1<<i-1&&i--,s=1<<i-1}if(1<r){for(;0!==p;)p>>=1,g++;r===1<<g-1&&g--,p=1<<g-1}l.childA=e(t,o,n,s,p),l.lowerBound=l.childA.lowerBound,l.upperBound=l.childA.upperBound,0<a-s&&(l.childB=e(t,o+s,n,a-s,p),l.lowerBound=Math.min(l.lowerBound,l.childB.lowerBound),l.upperBound=Math.max(l.upperBound,l.childB.upperBound),0<r-p&&(l.childC=e(t,o+s,n+p,a-s,r-p),l.lowerBound=Math.min(l.lowerBound,l.childC.lowerBound),l.upperBound=Math.max(l.upperBound,l.childC.upperBound))),0<r-p&&(l.childD=e(t,o,n+p,s,r-p),l.lowerBound=Math.min(l.lowerBound,l.childD.lowerBound),l.upperBound=Math.max(l.upperBound,l.childD.upperBound))}return l}(e,0,0,e[0].length-1,e.length-1)}function y(e,t,o,n,a,r){var l=(n+o+t+e)/4;return r<l?2:l<a?0:1}u.getCells=function(e,t){var o=[];return this.lowerBound>t||this.upperBound<e||(this.childA||this.childB||this.childC||this.childD?(this.childA&&(o=o.concat(this.childA.getCells(e,t))),this.childB&&(o=o.concat(this.childB.getCells(e,t))),this.childC&&(o=o.concat(this.childC.getCells(e,t))),this.childD&&(o=o.concat(this.childD.getCells(e,t)))):(this.lowerBound<=e||this.upperBound>=t)&&o.push({x:this.x,y:this.y})),o};var x={square:function(e,t,o,n,a,r){r.polygons&&e.polygons.push([[0,0],[0,1],[1,1],[1,0]])},triangle_bl:function(e,t,o,n,a,r){var l=r.interpolate(t,o,r.minV,r.maxV),s=r.interpolate(t,a,r.minV,r.maxV);r.polygons_full&&(e.edges.lb={path:[[0,s],[l,0]],move:{x:0,y:-1,enter:"tl"}}),r.polygons&&e.polygons.push([[0,s],[l,0],[0,0]])},triangle_br:function(e,t,o,n,a,r){var l=r.interpolate(t,o,r.minV,r.maxV),s=r.interpolate(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.br={path:[[l,0],[1,s]],move:{x:1,y:0,enter:"lb"}}),r.polygons&&e.polygons.push([[l,0],[1,s],[1,0]])},triangle_tr:function(e,t,o,n,a,r){var l=r.interpolate(o,n,r.minV,r.maxV),s=r.interpolate(a,n,r.minV,r.maxV);r.polygons_full&&(e.edges.rt={path:[[1,l],[s,1]],move:{x:0,y:1,enter:"br"}}),r.polygons&&e.polygons.push([[1,l],[s,1],[1,1]])},triangle_tl:function(e,t,o,n,a,r){var l=r.interpolate(a,n,r.minV,r.maxV),s=r.interpolate(t,a,r.minV,r.maxV);r.polygons_full&&(e.edges.tl={path:[[l,1],[0,s]],move:{x:-1,y:0,enter:"rt"}}),r.polygons&&e.polygons.push([[0,s],[0,1],[l,1]])},tetragon_t:function(e,t,o,n,a,r){var l=r.interpolate(o,n,r.minV,r.maxV),s=r.interpolate(t,a,r.minV,r.maxV);r.polygons_full&&(e.edges.rt={path:[[1,l],[0,s]],move:{x:-1,y:0,enter:"rt"}}),r.polygons&&e.polygons.push([[0,s],[0,1],[1,1],[1,l]])},tetragon_r:function(e,t,o,n,a,r){var l=r.interpolate(t,o,r.minV,r.maxV),s=r.interpolate(a,n,r.minV,r.maxV);r.polygons_full&&(e.edges.br={path:[[l,0],[s,1]],move:{x:0,y:1,enter:"br"}}),r.polygons&&e.polygons.push([[l,0],[s,1],[1,1],[1,0]])},tetragon_b:function(e,t,o,n,a,r){var l=r.interpolate(t,a,r.minV,r.maxV),s=r.interpolate(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.lb={path:[[0,l],[1,s]],move:{x:1,y:0,enter:"lb"}}),r.polygons&&e.polygons.push([[0,0],[0,l],[1,s],[1,0]])},tetragon_l:function(e,t,o,n,a,r){var l=r.interpolate(a,n,r.minV,r.maxV),s=r.interpolate(t,o,r.minV,r.maxV);r.polygons_full&&(e.edges.tl={path:[[l,1],[s,0]],move:{x:0,y:-1,enter:"tl"}}),r.polygons&&e.polygons.push([[0,0],[0,1],[l,1],[s,0]])},tetragon_bl:function(e,t,o,n,a,r){var l=r.interpolate_a(t,o,r.minV,r.maxV),s=r.interpolate_b(t,o,r.minV,r.maxV),p=r.interpolate_a(t,a,r.minV,r.maxV),i=r.interpolate_b(t,a,r.minV,r.maxV);r.polygons_full&&(e.edges.bl={path:[[l,0],[0,p]],move:{x:-1,y:0,enter:"rb"}},e.edges.lt={path:[[0,i],[s,0]],move:{x:0,y:-1,enter:"tr"}}),r.polygons&&e.polygons.push([[l,0],[0,p],[0,i],[s,0]])},tetragon_br:function(e,t,o,n,a,r){var l=r.interpolate_a(t,o,r.minV,r.maxV),s=r.interpolate_b(t,o,r.minV,r.maxV),p=r.interpolate_a(o,n,r.minV,r.maxV),i=r.interpolate_b(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.bl={path:[[l,0],[1,i]],move:{x:1,y:0,enter:"lt"}},e.edges.rb={path:[[1,p],[s,0]],move:{x:0,y:-1,enter:"tr"}}),r.polygons&&e.polygons.push([[l,0],[1,i],[1,p],[s,0]])},tetragon_tr:function(e,t,o,n,a,r){var l=r.interpolate_a(a,n,r.minV,r.maxV),s=r.interpolate_b(a,n,r.minV,r.maxV),p=r.interpolate_b(o,n,r.minV,r.maxV),i=r.interpolate_a(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.rb={path:[[1,i],[l,1]],move:{x:0,y:1,enter:"bl"}},e.edges.tr={path:[[s,1],[1,p]],move:{x:1,y:0,enter:"lt"}}),r.polygons&&e.polygons.push([[1,i],[l,1],[s,1],[1,p]])},tetragon_tl:function(e,t,o,n,a,r){var l=r.interpolate_a(a,n,r.minV,r.maxV),s=r.interpolate_b(a,n,r.minV,r.maxV),p=r.interpolate_b(t,a,r.minV,r.maxV),i=r.interpolate_a(t,a,r.minV,r.maxV);r.polygons_full&&(e.edges.tr={path:[[s,1],[0,i]],move:{x:-1,y:0,enter:"rb"}},e.edges.lt={path:[[0,p],[l,1]],move:{x:0,y:1,enter:"bl"}}),r.polygons&&e.polygons.push([[s,1],[0,i],[0,p],[l,1]])},tetragon_lr:function(e,t,o,n,a,r){var l=r.interpolate_a(t,a,r.minV,r.maxV),s=r.interpolate_b(t,a,r.minV,r.maxV),p=r.interpolate_b(o,n,r.minV,r.maxV),i=r.interpolate_a(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.lt={path:[[0,s],[1,p]],move:{x:1,y:0,enter:"lt"}},e.edges.rb={path:[[1,i],[0,l]],move:{x:-1,y:0,enter:"rb"}}),r.polygons&&e.polygons.push([[0,l],[0,s],[1,p],[1,i]])},tetragon_tb:function(e,t,o,n,a,r){var l=r.interpolate_a(a,n,r.minV,r.maxV),s=r.interpolate_b(a,n,r.minV,r.maxV),p=r.interpolate_b(t,o,r.minV,r.maxV),i=r.interpolate_a(t,o,r.minV,r.maxV);r.polygons_full&&(e.edges.tr={path:[[s,1],[p,0]],move:{x:0,y:-1,enter:"tr"}},e.edges.bl={path:[[i,0],[l,1]],move:{x:0,y:1,enter:"bl"}}),r.polygons&&e.polygons.push([[i,0],[l,1],[s,1],[p,0]])},pentagon_tr:function(e,t,o,n,a,r){var l=r.interpolate(a,n,r.minV,r.maxV),s=r.interpolate(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.tl={path:[[l,1],[1,s]],move:{x:1,y:0,enter:"lb"}}),r.polygons&&e.polygons.push([[0,0],[0,1],[l,1],[1,s],[1,0]])},pentagon_tl:function(e,t,o,n,a,r){var l=r.interpolate(t,a,r.minV,r.maxV),s=r.interpolate(a,n,r.minV,r.maxV);r.polygons_full&&(e.edges.lb={path:[[0,l],[s,1]],move:{x:0,y:1,enter:"br"}}),r.polygons&&e.polygons.push([[0,0],[0,l],[s,1],[1,1],[1,0]])},pentagon_br:function(e,t,o,n,a,r){var l=r.interpolate(t,o,r.minV,r.maxV),s=r.interpolate(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.rt={path:[[1,s],[l,0]],move:{x:0,y:-1,enter:"tl"}}),r.polygons&&e.polygons.push([[0,0],[0,1],[1,1],[1,s],[l,0]])},pentagon_bl:function(e,t,o,n,a,r){var l=r.interpolate(t,a,r.minV,r.maxV),s=r.interpolate(t,o,r.minV,r.maxV);r.polygons_full&&(e.edges.br={path:[[s,0],[0,l]],move:{x:-1,y:0,enter:"rt"}}),r.polygons&&e.polygons.push([[0,l],[0,1],[1,1],[1,0],[s,0]])},pentagon_tr_rl:function(e,t,o,n,a,r){var l=r.interpolate(t,a,r.minV,r.maxV),s=r.interpolate(a,n,r.minV,r.maxV),p=r.interpolate_b(o,n,r.minV,r.maxV),i=r.interpolate_a(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.tl={path:[[s,1],[1,p]],move:{x:1,y:0,enter:"lt"}},e.edges.rb={path:[[1,i],[0,l]],move:{x:-1,y:0,enter:"rt"}}),r.polygons&&e.polygons.push([[0,l],[0,1],[s,1],[1,p],[1,i]])},pentagon_rb_bt:function(e,t,o,n,a,r){var l=r.interpolate(o,n,r.minV,r.maxV),s=r.interpolate_b(t,o,r.minV,r.maxV),p=r.interpolate_a(t,o,r.minV,r.maxV),i=r.interpolate(a,n,r.minV,r.maxV);r.polygons_full&&(e.edges.rt={path:[[1,l],[s,0]],move:{x:0,y:-1,enter:"tr"}},e.edges.bl={path:[[p,0],[i,1]],move:{x:0,y:1,enter:"br"}}),r.polygons&&e.polygons.push([[i,1],[1,1],[1,l],[s,0],[p,0]])},pentagon_bl_lr:function(e,t,o,n,a,r){var l=r.interpolate(t,o,r.minV,r.maxV),s=r.interpolate_a(t,a,r.minV,r.maxV),p=r.interpolate_b(t,a,r.minV,r.maxV),i=r.interpolate(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.br={path:[[l,0],[0,s]],move:{x:-1,y:0,enter:"rb"}},e.edges.lt={path:[[0,p],[1,i]],move:{x:1,y:0,enter:"lb"}}),r.polygons&&e.polygons.push([[l,0],[0,s],[0,p],[1,i],[1,0]])},pentagon_lt_tb:function(e,t,o,n,a,r){var l=r.interpolate(t,a,r.minV,r.maxV),s=r.interpolate_a(a,n,r.minV,r.maxV),p=r.interpolate_b(a,n,r.minV,r.maxV),i=r.interpolate(t,o,r.minV,r.maxV);r.polygons_full&&(e.edges.lb={path:[[0,l],[s,1]],move:{x:0,y:1,enter:"bl"}},e.edges.tr={path:[[p,1],[i,0]],move:{x:0,y:-1,enter:"tl"}}),r.polygons&&e.polygons.push([[0,0],[0,l],[s,1],[p,1],[i,0]])},pentagon_bl_tb:function(e,t,o,n,a,r){var l=r.interpolate(t,a,r.minV,r.maxV),s=r.interpolate(a,n,r.minV,r.maxV),p=r.interpolate_b(t,o,r.minV,r.maxV),i=r.interpolate_a(t,o,r.minV,r.maxV);r.polygons_full&&(e.edges.bl={path:[[i,0],[0,l]],move:{x:-1,y:0,enter:"rt"}},e.edges.tl={path:[[s,1],[p,0]],move:{x:0,y:-1,enter:"tr"}}),r.polygons&&e.polygons.push([[0,l],[0,1],[s,1],[p,0],[i,0]])},pentagon_lt_rl:function(e,t,o,n,a,r){var l=r.interpolate_a(t,a,r.minV,r.maxV),s=r.interpolate_b(t,a,r.minV,r.maxV),p=r.interpolate(a,n,r.minV,r.maxV),i=r.interpolate(o,a,r.minV,r.maxV);r.polygons_full&&(e.edges.lt={path:[[0,s],[p,1]],move:{x:0,y:1,enter:"br"}},e.edges.rt={path:[[1,i],[0,l]],move:{x:-1,y:0,enter:"rb"}}),r.polygons&&e.polygons.push([[0,l],[0,s],[p,1],[1,1],[1,i]])},pentagon_tr_bt:function(e,t,o,n,a,r){var l=r.interpolate_a(a,n,r.minV,r.maxV),s=r.interpolate_b(a,n,r.minV,r.maxV),p=r.interpolate(o,n,r.minV,r.maxV),i=r.interpolate(t,o,r.minV,r.maxV);r.polygons_full&&(e.edges.br={path:[[i,0],[l,1]],move:{x:0,y:1,enter:"bl"}},e.edges.tr={path:[[s,1],[1,p]],move:{x:1,y:0,enter:"lb"}}),r.polygons&&e.polygons.push([[l,1],[s,1],[1,p],[1,0],[i,0]])},pentagon_rb_lr:function(e,t,o,n,a,r){var l=r.interpolate(t,a,r.minV,r.maxV),s=r.interpolate_b(o,n,r.minV,r.maxV),p=r.interpolate_a(o,n,r.minV,r.maxV),i=r.interpolate(t,o,r.minV,r.maxV);r.polygons_full&&(e.edges.lb={path:[[0,l],[1,s]],move:{x:1,y:0,enter:"lt"}},e.edges.rb={path:[[1,p],[i,0]],move:{x:0,y:-1,enter:"tl"}}),r.polygons&&e.polygons.push([[0,0],[0,l],[1,s],[1,p],[i,0]])},hexagon_lt_tr:function(e,t,o,n,a,r){var l=r.interpolate(t,a,r.minV,r.maxV),s=r.interpolate_a(a,n,r.minV,r.maxV),p=r.interpolate_b(a,n,r.minV,r.maxV),i=r.interpolate(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.lb={path:[[0,l],[s,1]],move:{x:0,y:1,enter:"bl"}},e.edges.tr={path:[[p,1],[1,i]],move:{x:1,y:0,enter:"lb"}}),r.polygons&&e.polygons.push([[0,0],[0,l],[s,1],[p,1],[1,i],[1,0]])},hexagon_bl_lt:function(e,t,o,n,a,r){var l=r.interpolate(t,o,r.minV,r.maxV),s=r.interpolate_a(t,a,r.minV,r.maxV),p=r.interpolate_b(t,a,r.minV,r.maxV),i=r.interpolate(a,n,r.minV,r.maxV);r.polygons_full&&(e.edges.br={path:[[l,0],[0,s]],move:{x:-1,y:0,enter:"rb"}},e.edges.lt={path:[[0,p],[i,1]],move:{x:0,y:1,enter:"br"}}),r.polygons&&e.polygons.push([[l,0],[0,s],[0,p],[i,1],[1,1],[1,0]])},hexagon_bl_rb:function(e,t,o,n,a,r){var l=r.interpolate_a(t,o,r.minV,r.maxV),s=r.interpolate_b(t,o,r.minV,r.maxV),p=r.interpolate(t,a,r.minV,r.maxV),i=r.interpolate(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.bl={path:[[l,0],[0,p]],move:{x:-1,y:0,enter:"rt"}},e.edges.rt={path:[[1,i],[s,0]],move:{x:0,y:-1,enter:"tr"}}),r.polygons&&e.polygons.push([[l,0],[0,p],[0,1],[1,1],[1,i],[s,0]])},hexagon_tr_rb:function(e,t,o,n,a,r){var l=r.interpolate(t,o,r.minV,r.maxV),s=r.interpolate(a,n,r.minV,r.maxV),p=r.interpolate_b(o,n,r.minV,r.maxV),i=r.interpolate_a(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.tl={path:[[s,1],[1,p]],move:{x:1,y:0,enter:"lt"}},e.edges.rb={path:[[1,i],[l,0]],move:{x:0,y:-1,enter:"tl"}}),r.polygons&&e.polygons.push([[0,0],[0,1],[s,1],[1,p],[1,i],[l,0]])},hexagon_lt_rb:function(e,t,o,n,a,r){var l=r.interpolate(t,a,r.minV,r.maxV),s=r.interpolate(a,n,r.minV,r.maxV),p=r.interpolate(o,n,r.minV,r.maxV),i=r.interpolate(t,o,r.minV,r.maxV);r.polygons_full&&(e.edges.lb={path:[[0,l],[s,1]],move:{x:0,y:1,enter:"br"}},e.edges.rt={path:[[1,p],[i,0]],move:{x:0,y:-1,enter:"tl"}}),r.polygons&&e.polygons.push([[0,0],[0,l],[s,1],[1,1],[1,p],[i,0]])},hexagon_bl_tr:function(e,t,o,n,a,r){var l=r.interpolate(t,o,r.minV,r.maxV),s=r.interpolate(t,a,r.minV,r.maxV),p=r.interpolate(a,n,r.minV,r.maxV),i=r.interpolate(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.br={path:[[l,0],[0,s]],move:{x:-1,y:0,enter:"rt"}},e.edges.tl={path:[[p,1],[1,i]],move:{x:1,y:0,enter:"lb"}}),r.polygons&&e.polygons.push([[l,0],[0,s],[0,1],[p,1],[1,i],[1,0]])},heptagon_tr:function(e,t,o,n,a,r){var l=r.interpolate_a(t,o,r.minV,r.maxV),s=r.interpolate_b(t,o,r.minV,r.maxV),p=r.interpolate_a(t,a,r.minV,r.maxV),i=r.interpolate_b(t,a,r.minV,r.maxV),g=r.interpolate(a,n,r.minV,r.maxV),m=r.interpolate(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.bl={path:[[l,0],[0,p]],move:{x:-1,y:0,enter:"rb"}},e.edges.lt={path:[[0,i],[g,1]],move:{x:0,y:1,enter:"br"}},e.edges.rt={path:[[1,m],[s,0]],move:{x:0,y:-1,enter:"tr"}}),r.polygons&&e.polygons.push([[l,0],[0,p],[0,i],[g,1],[1,1],[1,m],[s,0]])},heptagon_bl:function(e,t,o,n,a,r){var l=r.interpolate(t,o,r.minV,r.maxV),s=r.interpolate(t,a,r.minV,r.maxV),p=r.interpolate_a(a,n,r.minV,r.maxV),i=r.interpolate_b(a,n,r.minV,r.maxV),g=r.interpolate_b(o,n,r.minV,r.maxV),m=r.interpolate_a(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.lb={path:[[0,s],[p,1]],move:{x:0,y:1,enter:"bl"}},e.edges.tr={path:[[i,1],[1,g]],move:{x:1,y:0,enter:"lt"}},e.edges.rb={path:[[1,m],[l,0]],move:{x:0,y:-1,enter:"tl"}}),r.polygons&&e.polygons.push([[0,0],[0,s],[p,1],[i,1],[1,g],[1,m],[l,0]])},heptagon_tl:function(e,t,o,n,a,r){var l=r.interpolate_a(t,o,r.minV,r.maxV),s=r.interpolate_b(t,o,r.minV,r.maxV),p=r.interpolate(t,a,r.minV,r.maxV),i=r.interpolate(a,n,r.minV,r.maxV),g=r.interpolate_b(o,n,r.minV,r.maxV),m=r.interpolate_a(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.bl={path:[[l,0],[0,p]],move:{x:-1,y:0,enter:"rt"}},e.edges.tl={path:[[i,1],[1,g]],move:{x:1,y:0,enter:"lt"}},e.edges.rb={path:[[1,m],[s,0]],move:{x:0,y:-1,enter:"tr"}}),r.polygons&&e.polygons.push([[l,0],[0,p],[0,1],[i,1],[1,g],[1,m],[s,0]])},heptagon_br:function(e,t,o,n,a,r){var l=r.interpolate(t,o,r.minV,r.maxV),s=r.interpolate_a(t,a,r.minV,r.maxV),p=r.interpolate_b(t,a,r.minV,r.maxV),i=r.interpolate_a(a,n,r.minV,r.maxV),g=r.interpolate_b(a,n,r.minV,r.maxV),m=r.interpolate(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.br={path:[[l,0],[0,s]],move:{x:-1,y:0,enter:"rb"}},e.edges.lt={path:[[0,p],[i,1]],move:{x:0,y:1,enter:"bl"}},e.edges.tr={path:[[g,1],[1,m]],move:{x:1,y:0,enter:"lb"}}),r.polygons&&e.polygons.push([[l,0],[0,s],[0,p],[i,1],[g,1],[1,m],[1,0]])},octagon:function(e,t,o,n,a,r){var l=r.interpolate_a(t,o,r.minV,r.maxV),s=r.interpolate_b(t,o,r.minV,r.maxV),p=r.interpolate_a(t,a,r.minV,r.maxV),i=r.interpolate_b(t,a,r.minV,r.maxV),g=r.interpolate_a(a,n,r.minV,r.maxV),m=r.interpolate_b(a,n,r.minV,r.maxV),b=r.interpolate_b(o,n,r.minV,r.maxV),h=r.interpolate_a(o,n,r.minV,r.maxV);r.polygons_full&&(e.edges.bl={path:[[l,0],[0,p]],move:{x:-1,y:0,enter:"rb"}},e.edges.lt={path:[[0,i],[g,1]],move:{x:0,y:1,enter:"bl"}},e.edges.tr={path:[[m,1],[1,b]],move:{x:1,y:0,enter:"lt"}},e.edges.rb={path:[[1,h],[s,0]],move:{x:0,y:-1,enter:"tr"}}),r.polygons&&e.polygons.push([[l,0],[0,p],[0,i],[g,1],[m,1],[1,b],[1,h],[s,0]])}};function V(e,t,o,n){var a=0,r=e[o+1][t],l=e[o+1][t+1],s=e[o][t+1],p=e[o][t],i=n.minV,g=n.maxV;if(!(isNaN(p)||isNaN(s)||isNaN(l)||isNaN(r))){a|=r<i?0:g<r?128:64,a|=l<i?0:g<l?32:16,a|=s<i?0:g<s?8:4;var m=0,b={cval:a=+(a|=p<i?0:g<p?2:1),polygons:[],edges:{},x0:p,x1:s,x2:l,x3:r};switch(a){case 85:x.square(b,p,s,l,r,n);case 0:case 170:break;case 169:x.triangle_bl(b,p,s,l,r,n);break;case 166:x.triangle_br(b,p,s,l,r,n);break;case 154:x.triangle_tr(b,p,s,l,r,n);break;case 106:x.triangle_tl(b,p,s,l,r,n);break;case 1:x.triangle_bl(b,p,s,l,r,n);break;case 4:x.triangle_br(b,p,s,l,r,n);break;case 16:x.triangle_tr(b,p,s,l,r,n);break;case 64:x.triangle_tl(b,p,s,l,r,n);break;case 168:x.tetragon_bl(b,p,s,l,r,n);break;case 162:x.tetragon_br(b,p,s,l,r,n);break;case 138:x.tetragon_tr(b,p,s,l,r,n);break;case 42:x.tetragon_tl(b,p,s,l,r,n);break;case 2:x.tetragon_bl(b,p,s,l,r,n);break;case 8:x.tetragon_br(b,p,s,l,r,n);break;case 32:x.tetragon_tr(b,p,s,l,r,n);break;case 128:x.tetragon_tl(b,p,s,l,r,n);break;case 5:x.tetragon_b(b,p,s,l,r,n);break;case 20:x.tetragon_r(b,p,s,l,r,n);break;case 80:x.tetragon_t(b,p,s,l,r,n);break;case 65:x.tetragon_l(b,p,s,l,r,n);break;case 165:x.tetragon_b(b,p,s,l,r,n);break;case 150:x.tetragon_r(b,p,s,l,r,n);break;case 90:x.tetragon_t(b,p,s,l,r,n);break;case 105:x.tetragon_l(b,p,s,l,r,n);break;case 160:x.tetragon_lr(b,p,s,l,r,n);break;case 130:x.tetragon_tb(b,p,s,l,r,n);break;case 10:x.tetragon_lr(b,p,s,l,r,n);break;case 40:x.tetragon_tb(b,p,s,l,r,n);break;case 101:x.pentagon_tr(b,p,s,l,r,n);break;case 149:x.pentagon_tl(b,p,s,l,r,n);break;case 86:x.pentagon_bl(b,p,s,l,r,n);break;case 89:x.pentagon_br(b,p,s,l,r,n);break;case 69:x.pentagon_tr(b,p,s,l,r,n);break;case 21:x.pentagon_tl(b,p,s,l,r,n);break;case 84:x.pentagon_bl(b,p,s,l,r,n);break;case 81:x.pentagon_br(b,p,s,l,r,n);break;case 96:x.pentagon_tr_rl(b,p,s,l,r,n);break;case 24:x.pentagon_rb_bt(b,p,s,l,r,n);break;case 6:x.pentagon_bl_lr(b,p,s,l,r,n);break;case 129:x.pentagon_lt_tb(b,p,s,l,r,n);break;case 74:x.pentagon_tr_rl(b,p,s,l,r,n);break;case 146:x.pentagon_rb_bt(b,p,s,l,r,n);break;case 164:x.pentagon_bl_lr(b,p,s,l,r,n);break;case 41:x.pentagon_lt_tb(b,p,s,l,r,n);break;case 66:x.pentagon_bl_tb(b,p,s,l,r,n);break;case 144:x.pentagon_lt_rl(b,p,s,l,r,n);break;case 36:x.pentagon_tr_bt(b,p,s,l,r,n);break;case 9:x.pentagon_rb_lr(b,p,s,l,r,n);break;case 104:x.pentagon_bl_tb(b,p,s,l,r,n);break;case 26:x.pentagon_lt_rl(b,p,s,l,r,n);break;case 134:x.pentagon_tr_bt(b,p,s,l,r,n);break;case 161:x.pentagon_rb_lr(b,p,s,l,r,n);break;case 37:x.hexagon_lt_tr(b,p,s,l,r,n);break;case 148:x.hexagon_bl_lt(b,p,s,l,r,n);break;case 82:x.hexagon_bl_rb(b,p,s,l,r,n);break;case 73:x.hexagon_tr_rb(b,p,s,l,r,n);break;case 133:x.hexagon_lt_tr(b,p,s,l,r,n);break;case 22:x.hexagon_bl_lt(b,p,s,l,r,n);break;case 88:x.hexagon_bl_rb(b,p,s,l,r,n);break;case 97:x.hexagon_tr_rb(b,p,s,l,r,n);break;case 145:case 25:x.hexagon_lt_rb(b,p,s,l,r,n);break;case 70:case 100:x.hexagon_bl_tr(b,p,s,l,r,n);break;case 17:0===(m=y(p,s,l,r,i,g))?(x.triangle_bl(b,p,s,l,r,n),x.triangle_tr(b,p,s,l,r,n)):x.hexagon_lt_rb(b,p,s,l,r,n);break;case 68:0===(m=y(p,s,l,r,i,g))?(x.triangle_tl(b,p,s,l,r,n),x.triangle_br(b,p,s,l,r,n)):x.hexagon_bl_tr(b,p,s,l,r,n);break;case 153:2===(m=y(p,s,l,r,i,g))?(x.triangle_bl(b,p,s,l,r,n),x.triangle_tr(b,p,s,l,r,n)):x.hexagon_lt_rb(b,p,s,l,r,n);break;case 102:2===(m=y(p,s,l,r,i,g))?(x.triangle_tl(b,p,s,l,r,n),x.triangle_br(b,p,s,l,r,n)):x.hexagon_bl_tr(b,p,s,l,r,n);break;case 152:2===(m=y(p,s,l,r,i,g))?(x.triangle_tr(b,p,s,l,r,n),x.tetragon_bl(b,p,s,l,r,n)):x.heptagon_tr(b,p,s,l,r,n);break;case 137:2===(m=y(p,s,l,r,i,g))?(x.triangle_bl(b,p,s,l,r,n),x.tetragon_tr(b,p,s,l,r,n)):x.heptagon_bl(b,p,s,l,r,n);break;case 98:2===(m=y(p,s,l,r,i,g))?(x.triangle_tl(b,p,s,l,r,n),x.tetragon_br(b,p,s,l,r,n)):x.heptagon_tl(b,p,s,l,r,n);break;case 38:2===(m=y(p,s,l,r,i,g))?(x.triangle_br(b,p,s,l,r,n),x.tetragon_tl(b,p,s,l,r,n)):x.heptagon_br(b,p,s,l,r,n);break;case 18:0===(m=y(p,s,l,r,i,g))?(x.triangle_tr(b,p,s,l,r,n),x.tetragon_bl(b,p,s,l,r,n)):x.heptagon_tr(b,p,s,l,r,n);break;case 33:0===(m=y(p,s,l,r,i,g))?(x.triangle_bl(b,p,s,l,r,n),x.tetragon_tr(b,p,s,l,r,n)):x.heptagon_bl(b,p,s,l,r,n);break;case 72:0===(m=y(p,s,l,r,i,g))?(x.triangle_tl(b,p,s,l,r,n),x.tetragon_br(b,p,s,l,r,n)):x.heptagon_tl(b,p,s,l,r,n);break;case 132:0===(m=y(p,s,l,r,i,g))?(x.triangle_br(b,p,s,l,r,n),x.tetragon_tl(b,p,s,l,r,n)):x.heptagon_br(b,p,s,l,r,n);break;case 136:0===(m=y(p,s,l,r,i,g))?(x.tetragon_tl(b,p,s,l,r,n),x.tetragon_br(b,p,s,l,r,n)):1===m?x.octagon(b,p,s,l,r,n):(x.tetragon_bl(b,p,s,l,r,n),x.tetragon_tr(b,p,s,l,r,n));break;case 34:0===(m=y(p,s,l,r,i,g))?(x.tetragon_bl(b,p,s,l,r,n),x.tetragon_tr(b,p,s,l,r,n)):1===m?x.octagon(b,p,s,l,r,n):(x.tetragon_tl(b,p,s,l,r,n),x.tetragon_br(b,p,s,l,r,n))}return b}}e.isoLines=o,e.isoBands=function(e,t,o,n){var a={};if(!e)throw new Error("data is required");if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Error("data should be an array of arrays");if(null==t)throw new Error("lowerBound is required");if(null==o)throw new Error("bandWidth is required");if(isNaN(+t))throw new Error("lowerBound must be a number");if(isNaN(+o))throw new Error("bandWidth must be a number");if(n&&"object"!=typeof n)throw new Error("options must be an object");n=n||{};for(var r=Object.keys(h),l=0;l<r.length;l++){var s=r[l],p=n[s];p=null!=p?p:h[s],a[s]=p}a.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+t+":"+(t+o)+"]"),a.polygons_full=!a.polygons;var i=t+Math.abs(o);a.minV=t,a.maxV=i,_(e).getCells(t,i).forEach(function(e){console.log(e)});for(var g,m={rows:e.length-1,cols:e[0].length-1,cells:[],minV:t,maxV:i},b=0;b<m.rows;++b)for(m.cells[b]=[],l=0;l<m.cols;++l)m.cells[b][l]=V(e,l,b,a);return a.polygons?(a.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),g=c(m,a)):(a.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),g=function(e,t){for(var o=e.rows,n=e.cols,a=[],r=[["rt","rb"],["br","bl"],["lb","lt"],["tl","tr"]],l=[0,-1,0,1],s=[-1,0,1,0],p=["bl","lb","lt","tl","tr","rt","rb","br"],i={bl:1,br:1,lb:2,lt:2,tl:3,tr:3,rt:0,rb:0},g=!0,m=0;m<o;m++)if(e.cells[m][0].x0<e.minV||e.cells[m][0].x0>e.maxV||e.cells[m][n-1].x1<e.minV||e.cells[m][n-1].x1>e.maxV){g=!1;break}if(g&&(e.cells[o-1][0].x3<e.minV||e.cells[o-1][0].x3>e.maxV||e.cells[o-1][n-1].x2<e.minV||e.cells[o-1][n-1].x2>e.maxV)&&(g=!1),g)for(var b=0;b<n-1;b++)if(e.cells[0][b].x1<e.minV||e.cells[0][b].x1>e.maxV||e.cells[o-1][b].x2<e.minV||e.cells[o-1][b].x2>e.maxV){g=!1;break}for(g&&(t.linearRing?a.push([[0,0],[0,o],[n,o],[n,0],[0,0]]):a.push([[0,0],[0,o],[n,o],[n,0]])),m=0;m<o;m++)for(b=0;b<n;b++)if(void 0!==e.cells[m][b]){var h=e.cells[m][b];if(0===h.cval||85===h.cval||170===h.cval)continue;for(var c=null,u=0;u<8;u++)if(c=p[u],"object"==typeof h.edges[c]){var _=[],y=c,x=b,V=m,f=!1,d=[b+(k=h.edges[c]).path[0][0],m+k.path[0][1]];for(_.push(d);!f;){var v=e.cells[V][x];if("object"!=typeof v.edges[y])break;var k=v.edges[y];delete v.edges[y];var w=k.path[1];if(w[0]+=x,w[1]+=V,_.push(w),y=k.move.enter,x+=k.move.x,V+=k.move.y,void 0===e.cells[V]||void 0===e.cells[V][x]){var B=0,C=0;if(x===n?(x--,B=0):x<0?(x++,B=2):V===o?(V--,B=3):V<0&&(V++,B=1),x===b&&V===m&&B===i[c]){f=!0,y=c;break}for(;;){var N=!1;if(4<C){console.log("Direction change counter overflow! This should never happen!");break}v=e.cells[V][x];for(var M=0;M<r[B].length;M++){var j=r[B][M];if("object"==typeof v.edges[j]){k=v.edges[j],_.push(S(x,V,B,k.path)),y=j,N=!0;break}}if(N)break;if(_.push(q(x,V,B)),x+=l[B],V+=s[B],void 0!==e.cells[V]&&void 0!==e.cells[V][x]||(x-=l[B],V-=s[B],B=(B+1)%4,C++),x===b&&V===m&&B===i[c]){f=!0,y=c;break}}}}!t.linearRing||_[_.length-1][0]===d[0]&&_[_.length-1][1]===d[1]||_.push(d),a.push(_)}}return a}(m,a)),"function"==typeof a.successCallback&&a.successCallback(g),g},e.isoContours=o,Object.defineProperty(e,"__esModule",{value:!0})});
